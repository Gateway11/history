package com.rokid.server;

import android.util.Base64;
import android.util.Slog;

/**
 * Created by insswer on 2016/1/25.
 */
public class RKKey {
    private static final String TAG = "RKKey";
    private static int LEN = 64;
    private static int VALID_INPUT_LEN = 30;
    private static int VALID_LEN = 40;
    private static native final int native_getRokidKey(byte[] key_buffer);
    public String encodeBase64(byte[] input, int ret) throws Exception {
        byte[] input32 = new byte[ret];
        for (int i = 0; i < input32.length; i++) {
            input32[i] = input[i];
        }
        byte[] encode = Base64.encode(input32, Base64.NO_WRAP);
        String enc = new String(encode);
        return enc;
    }

    public String getKeyBase64() throws Exception {
        byte[] key_buffer = new byte[LEN];
        int ret = native_getRokidKey(key_buffer);
        if (ret == -1) {
            Slog.e(TAG, "INVALID ROKID KEY!");
            return null;
        }
        return encodeBase64(key_buffer, ret);
    }
}
